# Building Forge - Main Process

هذا المجلد يحتوي على العملية الرئيسية لتطبيق Building Forge المبني باستخدام Electron.

## البنية

```
src/main/
├── main.ts                 # نقطة الدخول الرئيسية للتطبيق
├── utils/
│   └── environment.ts      # مساعدات البيئة والإعدادات
├── windows/
│   └── mainWindow.ts       # إنشاء وإدارة النافذة الرئيسية
├── ipc/
│   └── ipcHandlers.ts      # معالجات التواصل بين العمليات
├── menu/
│   └── applicationMenu.ts  # قوائم التطبيق الأصلية
├── preload/
│   └── preload.ts          # سكريبت preload للتواصل الآمن
└── __tests__/              # اختبارات العملية الرئيسية
```

## الميزات المنجزة

### ✅ العملية الرئيسية الأساسية (main.ts)

- إدارة دورة حياة التطبيق
- إعدادات الأمان المحسنة
- نظام التحديثات التلقائية
- معالجة الأخطاء الشاملة

### ✅ إدارة النوافذ (windows/mainWindow.ts)

- إنشاء النافذة الرئيسية مع إعدادات محسنة
- دعم الشاشات المتعددة
- إعدادات أمان متقدمة (context isolation, webSecurity)
- دعم منصات متعددة (Windows, macOS, Linux)

### ✅ طبقة IPC الآمنة (ipc/ipcHandlers.ts + preload/preload.ts)

- تواصل آمن بين العمليات باستخدام contextBridge
- معالجات لعمليات الملفات (فتح، حفظ، تصدير)
- معالجة الأخطاء والتحقق من صحة البيانات
- واجهة TypeScript محددة للأمان

### ✅ نظام القوائم الأصلية (menu/applicationMenu.ts)

- قوائم أصلية للمنصات المختلفة
- اختصارات لوحة المفاتيح
- دعم أدوات البناء المختلفة
- قوائم تطوير في وضع التطوير

### ✅ مساعدات البيئة (utils/environment.ts)

- كشف بيئة التطوير/الإنتاج
- معلومات المنصة والنظام
- مسارات التطبيق والبيانات

## الاختبارات

تم إنشاء اختبارات شاملة للعملية الرئيسية:

```bash
# تشغيل اختبارات العملية الرئيسية
npm test src/main

# تشغيل الاختبارات الأساسية فقط
npm test src/main/__tests__/basic.test.ts
```

### تغطية الاختبارات

- ✅ اختبار إنشاء النوافذ وإدارتها
- ✅ اختبار معالجات IPC والتواصل الآمن
- ✅ اختبار نظام القوائم والاختصارات
- ✅ اختبار مساعدات البيئة
- ✅ اختبار بنية الملفات

## الأمان

تم تطبيق أفضل ممارسات الأمان في Electron:

- **Context Isolation**: تفعيل العزل بين السياقات
- **Node Integration**: إيقاف تكامل Node.js في العارض
- **Web Security**: تفعيل أمان الويب في الإنتاج
- **CSP Headers**: إعداد Content Security Policy
- **Preload Scripts**: استخدام preload للتواصل الآمن
- **External Links**: منع التنقل للمواقع الخارجية

## التطوير

### البناء

```bash
# بناء العملية الرئيسية
npm run build:main

# بناء مع المراقبة
npm run dev:main
```

### التشغيل

```bash
# تشغيل التطبيق
npm start

# تشغيل في وضع التطوير
npm run dev
```

## المتطلبات المحققة

هذا التنفيذ يحقق المتطلبات التالية من وثيقة التصميم:

- **1.1-1.5**: البنية الأساسية والتكوين
- **7.1, 7.2, 7.5**: إدارة المشاريع والملفات
- **8.1, 8.2**: عمليات التصدير
- **10.1**: اختصارات لوحة المفاتيح

## الخطوات التالية

المهمة التالية هي تطوير النظام الأساسي للواجهة (المهمة 3) والتي تشمل:

- إعداد React و TypeScript
- تطوير خدمة Electron في React
- إعداد إدارة الحالة مع Zustand
- كتابة اختبارات الخصائص
